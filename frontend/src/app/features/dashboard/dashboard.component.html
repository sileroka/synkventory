<div class="dashboard">
  <h1 class="mb-4">Dashboard</h1>
  <p class="text-color-secondary mb-4">
    Welcome to Synkventory. Stock in sync.
  </p>

  <div class="grid">
    <!-- Low Stock Alert Card -->
    <div class="col-12 md:col-6 lg:col-4">
      <p-card
        styleClass="dashboard-card low-stock-card"
        (click)="navigateToLowStock()"
      >
        <ng-template pTemplate="header">
          <div class="card-header">
            <i class="pi pi-exclamation-triangle text-4xl text-orange-500"></i>
          </div>
        </ng-template>
        <div class="card-content">
          <div
            class="text-3xl font-bold mb-2"
            [class.text-orange-500]="lowStockCount > 0"
          >
            {{ lowStockCount }}
          </div>
          <div class="text-color-secondary">Items Need Reorder</div>
        </div>
        <ng-template pTemplate="footer">
          <p-button
            label="View All"
            icon="pi pi-arrow-right"
            [text]="true"
            size="small"
          ></p-button>
        </ng-template>
      </p-card>
    </div>
  </div>

  <!-- Low Stock Items Table -->
  <div class="mt-4" *ngIf="lowStockAlerts.length > 0">
    <h2 class="text-xl font-semibold mb-3">
      <i class="pi pi-exclamation-triangle text-orange-500 mr-2"></i>
      Items Needing Reorder
    </h2>

    <p-table
      [value]="lowStockAlerts"
      [loading]="loading"
      styleClass="p-datatable-sm p-datatable-striped"
    >
      <ng-template pTemplate="header">
        <tr>
          <th>SKU</th>
          <th>Name</th>
          <th>Current Qty</th>
          <th>Reorder Point</th>
          <th>Suggested Order</th>
          <th>Status</th>
          <th>Actions</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-alert>
        <tr>
          <td>{{ alert.sku }}</td>
          <td>{{ alert.name }}</td>
          <td
            class="font-semibold"
            [class.text-red-500]="alert.quantity === 0"
            [class.text-orange-500]="alert.quantity > 0"
          >
            {{ alert.quantity }}
          </td>
          <td>{{ alert.reorderPoint }}</td>
          <td class="font-semibold text-primary">
            {{ alert.suggestedOrderQuantity }}
          </td>
          <td>
            <p-tag
              [value]="getStatusLabel(alert.status)"
              [severity]="getStatusSeverity(alert.status)"
            ></p-tag>
          </td>
          <td>
            <p-button
              icon="pi pi-eye"
              [rounded]="true"
              [text]="true"
              severity="secondary"
              pTooltip="View Item"
              tooltipPosition="left"
              (onClick)="navigateToItem(alert.id)"
            ></p-button>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="7" class="text-center text-color-secondary">
            <i class="pi pi-check-circle text-green-500 mr-2"></i>
            All inventory levels are healthy!
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>

  <!-- All Good Message -->
  <div class="mt-4" *ngIf="lowStockAlerts.length === 0 && !loading">
    <p-card>
      <div class="text-center py-4">
        <i class="pi pi-check-circle text-green-500 text-5xl mb-3"></i>
        <h3 class="text-xl font-semibold text-green-700">
          All Inventory Levels Healthy
        </h3>
        <p class="text-color-secondary">No items currently need reordering.</p>
      </div>
    </p-card>
  </div>
</div>
