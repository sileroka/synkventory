<div class="reorder-suggestions">
  <p-card header="Reorder Suggestions" [style]="{ 'margin-bottom': '1rem' }">
    <div class="controls">
      <div class="control-group">
        <label>Lead Time (days)</label>
        <input type="number" [(ngModel)]="leadTimeDays" min="1" max="90" />
        <button
          pButton
          type="button"
          label="Refresh"
          class="p-button-sm"
          (click)="refresh()"
        ></button>
      </div>
      <div class="control-group">
        <label>Search</label>
        <input
          pInputText
          type="text"
          [(ngModel)]="search"
          placeholder="Item ID or name"
        />
      </div>
      <div class="control-group" style="margin-left: auto">
        <label>Supplier</label>
        <input
          pInputText
          type="text"
          [(ngModel)]="supplierName"
          placeholder="Supplier name (optional)"
        />
        <button
          pButton
          type="button"
          label="Create Purchase Order"
          class="p-button-sm p-button-success"
          (click)="createPurchaseOrder()"
        ></button>
      </div>
    </div>
  </p-card>

  <p-table
    [value]="filtered()"
    [loading]="isLoading()"
    [tableStyle]="{ 'min-width': '60rem' }"
    [rowHover]="true"
    [paginator]="true"
    [rows]="25"
    [responsiveLayout]="'stack'"
  >
    <ng-template pTemplate="header">
      <tr>
        <th style="width: 2rem"></th>
        <th>Name</th>
        <th>Item ID</th>
        <th>Current Quantity</th>
        <th>Forecasted Need</th>
        <th>Suggested Qty</th>
        <th>Suggested Date</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-s>
      <tr>
        <td>
          <input
            type="checkbox"
            #box
            (change)="toggleSelection(s.itemId, box.checked)"
          />
        </td>
        <td>{{ s.itemName }}</td>
        <td>{{ s.itemId }}</td>
        <td>
          <p-tag
            [severity]="s.currentQuantity < s.forecastedNeed ? 'warning' : 'success'"
            [value]="s.currentQuantity"
          ></p-tag>
        </td>
        <td>{{ s.forecastedNeed }}</td>
        <td>
          <p-tag
            [severity]="s.suggestedOrderQuantity > 0 ? 'danger' : 'success'"
            [value]="s.suggestedOrderQuantity"
          ></p-tag>
        </td>
        <td>{{ s.suggestedOrderDate || '-' }}</td>
      </tr>
    </ng-template>
  </p-table>
</div>
